<?php require_once '../vendor/autoload.php';require_once 'email_config.php';use PHPMailer\PHPMailer\PHPMailer;use PHPMailer\PHPMailer\SMTP;use PHPMailer\PHPMailer\Exception;function testEmailSetup(){echo "<h2>Email Configuration Test</h2>";echo "<p><strong>Test 1:</strong> PHPMailer class exists: ".(class_exists('PHPMailer\PHPMailer\PHPMailer')?"✅ YES":"❌ NO")."</p>";echo "<p><strong>Test 2:</strong> SMTP Configuration:</p>";echo "<ul>";echo "<li>Host: ".SMTP_HOST."</li>";echo "<li>Port: ".SMTP_PORT."</li>";echo "<li>Secure: ".SMTP_SECURE."</li>";echo "<li>Username: ".SMTP_USERNAME."</li>";echo "<li>Password: ".(SMTP_PASSWORD==='your_app_password_here'?"❌ NOT CONFIGURED":"✅ CONFIGURED")."</li>";echo "</ul>";if(isset($_POST['send_test'])){$testEmail=$_POST['test_email']?? '';if(empty($testEmail)||!filter_var($testEmail,FILTER_VALIDATE_EMAIL)){echo "<p style='color: red;'>❌ Please enter a valid email address to test.</p>";}else{echo"<p><strong>Test 3:</strong> Sending test email to: $testEmail</p>";$emailSent=false;$errorDetails="";if(SMTP_PASSWORD!=='your_app_password_here'){try{$mail=new PHPMailer(true);$mail->isSMTP();$mail->Host=SMTP_HOST;$mail->SMTPAuth=true;$mail->Username=SMTP_USERNAME;$mail->Password=SMTP_PASSWORD;$mail->SMTPSecure=SMTP_SECURE==='tls'?PHPMailer::ENCRYPTION_STARTTLS:PHPMailer::ENCRYPTION_SMTPS;$mail->Port=SMTP_PORT;$mail->setFrom(SMTP_USERNAME,FROM_NAME);$mail->addAddress($testEmail);$mail->isHTML(true);$mail->Subject='DN Tours - Email Test';$mail->Body='<h2>Email Test Successful!</h2><p>Your email configuration is working correctly.</p><p>Test sent at: '.date('Y-m-d H:i:s').'</p>';$mail->send();$emailSent=true;echo "<p style='color: green;'>✅ SMTP Email sent successfully!</p>";}catch(Exception $e){$errorDetails=$e->getMessage();echo "<p style='color: orange;'>⚠️ SMTP failed: ".htmlspecialchars($errorDetails)."</p>";}}else{echo "<p style='color: orange;'>⚠️ SMTP not configured, skipping SMTP test.</p>";}if(!$emailSent&&USE_SMTP_FALLBACK){try{$mail=new PHPMailer(false);$mail->isMail();$mail->setFrom(SMTP_USERNAME,FROM_NAME);$mail->addAddress($testEmail);$mail->isHTML(true);$mail->Subject='DN Tours - Email Test (PHP Mail)';$mail->Body='<h2>Email Test Successful!</h2><p>Your PHP mail() function is working correctly.</p><p>Test sent at: '.date('Y-m-d H:i:s').'</p>';if($mail->send()){$emailSent=true;echo "<p style='color: green;'>✅ PHP mail() sent successfully!</p>";}else{echo "<p style='color: red;'>❌ PHP mail() failed: ".htmlspecialchars($mail->ErrorInfo)."</p>";}}catch(Exception $e){echo "<p style='color: red;'>❌ PHP mail() exception: ".htmlspecialchars($e->getMessage())."</p>";}}if(!$emailSent){echo "<p style='color: red;'>❌ All email methods failed.</p>";}}}} ?><!doctypehtml><html lang="en"><head><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1"name="viewport"><title>Email Test - DN Tours</title><style>body{font-family:Arial,sans-serif;max-width:800px;margin:2rem auto;padding:2rem;background:#f5f5f5}.container{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.1)}.back-link{color:#ff7e29;text-decoration:none;margin-bottom:2rem;display:inline-block}.back-link:hover{text-decoration:underline}input[type=email]{padding:.5rem;border:1px solid #ddd;border-radius:4px;width:300px}button{padding:.5rem 1rem;background:#ff7e29;color:#fff;border:none;border-radius:4px;cursor:pointer}button:hover{background:#e66a20}</style></head><body><div class="container"><a href="contact.php"class="back-link">← Back to Contact Page</a><?php testEmailSetup(); ?><hr><h3>Send Test Email</h3><form method="POST"><p><label for="test_email">Enter your email address to receive a test email:</label><br><input id="test_email"name="test_email"placeholder="your@email.com"required type="email"> <button name="send_test"type="submit">Send Test Email</button></p></form><hr><h3>Setup Instructions</h3><ol><li><strong>For Gmail SMTP:</strong><ul><li>Go to <a href="https://myaccount.google.com/"target="_blank">Google Account Settings</a></li><li>Enable 2-factor authentication</li><li>Go to Security > App passwords</li><li>Generate an app password for "Mail"</li><li>Update <code>SMTP_PASSWORD</code> in <code>email_config.php</code></li></ul></li><li><strong>Alternative:</strong> The system will fallback to PHP's mail() function if SMTP fails</li><li><strong>For hosting providers:</strong> Contact your hosting provider about SMTP settings</li></ol></div></body></html>